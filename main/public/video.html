<!DOCTYPE html>
<html>
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="styles.css">
<link rel="stylesheet" href="magic.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<body>
  <div="webgl" class="webgl">
    <iframe class="webgl" src="http://webglsamples.org/electricflower/electricflower.html" style="width: 100%;height: 100%; position: fixed; z-index: -1"></iframe>
  <nav style="float: right; background-color: azure; max-width: 200px">
  <a href="index.html">Test Page</a> |
  </nav>

  <div class="container">
    <div id"title" class= "title" style="background-color: azure; max-width: 400px">
      <h1>Where Videos Rule</h1>
</div>

  <div id="video-div" style="max-width: 500px; max-height: 400px">
  </div>

  <div class= "Prev" style="float: right; z-index: 10">
    <button onclick="PrevVideo()" type="button">Previous Video</button>
  </div>
  <script id="video" type="text/x-handlebars-template">
    <h3>Video List {{name}}</h3>
    <div class="media">

      <div class="media-body">
        <dl class="dl-horizontal">
          <dt>Name</dt><dd class="clearfix">{{name}}</dd>
          <dt>Type</dt><dd>{{type}}</dd>
        </dl>
      </div>
    </div>

    <div id="player" style="margin: auto; width: 100%; background-color: black"></div>

    </div>

  </script>
  <div class= "Next" style="float: right">
    <button onclick="NextVideo()" type="button">Next Video</button>
  </div>



</div>



  <script>
    $('.player').hover(function () {
      $(this).addClass('magictime spaceInLeft');
     });

     $('.title').hover(function () {
       $(this).addClass('magictime spaceInRight');
      });

        // 2. This code loads the IFrame Player API code asynchronously.
        var tag = document.createElement('script');

        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // 3. This function creates an <iframe> (and YouTube player)
        //    after the API code downloads.
        var player;
        var database;
        var VidID;
        $.get('http://localhost:3000/db', {}, function(data){
          database = data;
         });

        function onYouTubeIframeAPIReady(VidID) {

          if (VidID === undefined){VidID = 0};
          player = new YT.Player('player', {
            height: '390',
            width: '640',
            videoId: database.data.videos[VidID].id,
            events: {
              'onReady': onPlayerReady,
            }
          });
        }

        // 4. The API will call this function when the video player is ready.
        function onPlayerReady(event) {
          //event.target.playVideo();
        }

        function NextVideo(){
          if (VidID === undefined){VidID = 0};
          console.log("New ID! " + VidID);
          var vid = database.data.videos[VidID+1].id
          if (vid == undefined){console.log("No more vids yo");return}
          console.log("New ID! " + vid);
          player.loadVideoById({videoId:vid,
                      suggestedQuality:"large"})
        }

        function PrevVideo(){
          if (VidID === undefined){return};

          var vid = database.data.videos[VidID-1].id
          if (vid == undefined){console.log("No more vids yo");return}
          console.log("New ID! " + vid);
          player.loadVideoById({videoId:vid,
                      suggestedQuality:"small"})
        }


  </script>


  <script>
  //Script to pull in db data
    //debugger;
    (function() {
      var videoSource = document.getElementById('video').innerHTML,
          videoTemplate = Handlebars.compile(videoSource),
          videoPlaceholder = document.getElementById('video-div');

      $.get('http://localhost:3000/db', {}, function(data){
        console.log(data.data.videos[0]);
            videoPlaceholder.innerHTML = videoTemplate(data.data.videos[0])
       });

    })();
  </script>



</body>
</html>
